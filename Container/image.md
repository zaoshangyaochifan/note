0. RootFS

rootfs包含一个操作系统运行所需的文件系统，例如/dev、/proc、/bin、/etc。

传统的Linux系统启动时，首先挂载一个只读的rootfs，当系统检测其完整性之后，再将其切换为读写模式。Docker Daemon在为容器挂在rootfs时，首先将rootfs设为只读模式，挂载完毕之后，利用联合挂载在已有的rootfs上再挂载一个读写层。

读写层位于容器文件系统最顶层，其下可以联合挂载多个只读层。容器中的文件系统变化时，讲变化的文件内容写入到读写层，隐藏只读层中的老版本文件。

1. Docker镜像特点：

+ 分层。修改容器中的文件时，只记录在最上方的读写层中，不覆盖下层文件系统。Docker commit只提交读写层中记录的修改。
+ 写时复制。多个容器之间共享镜像，启动时不需要将每个镜像都复制一份，减少了对磁盘空间的占用和容器启动时间。
+ 内容寻址。
+ 联合挂载。在一个挂载点同时挂载多个文件系统，将挂载点源目录与被挂载内容进行整合。联合挂载将多个镜像层的文件系统挂载到同一个挂载点，实现一个统一的文件系统视图，由aufs、overlay等存储驱动实现。(所以这块核心的联合挂载不是docker实现的)

aufs4-standlone的源代码在git://github.com/sfjro/aufs4-standalone.git